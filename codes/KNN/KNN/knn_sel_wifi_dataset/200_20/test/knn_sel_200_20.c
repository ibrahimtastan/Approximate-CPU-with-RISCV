// C++ program to find groups of unknown
// Points using K nearest neighbour algorithm.
// Dataset of wall-following-robot 200 data and 20 test data.
#include <stdio.h>
#include <stdlib.h>
#include <math.h>

typedef struct _Point
{
    int distance; // Distance from test point
    int a,b,c,d,e,f,g;     // Co-ordinate of point
    int val;     // Group of point
} Point;


int* knn(){


//arr = 0x200;
static Point arr [200] = {
{	0,	64,	56,	61,	66,	71,	82,	81,	1	},
{	0,	68,	57,	61,	65,	71,	85,	85,	1	},
{	0,	63,	60,	60,	67,	76,	85,	84,	1	},
{	0,	61,	60,	68,	62,	77,	90,	80,	1	},
{	0,	63,	65,	60,	63,	77,	81,	87,	1	},
{	0,	64,	55,	63,	66,	76,	88,	83,	1	},
{	0,	65,	61,	65,	67,	69,	87,	84,	1	},
{	0,	61,	63,	58,	66,	74,	87,	82,	1	},
{	0,	65,	60,	59,	63,	76,	86,	82,	1	},
{	0,	62,	60,	66,	68,	80,	86,	91,	1	},
{	0,	67,	61,	62,	67,	77,	83,	91,	1	},
{	0,	65,	59,	61,	67,	72,	86,	81,	1	},
{	0,	63,	57,	61,	65,	73,	84,	84,	1	},
{	0,	66,	60,	65,	62,	70,	85,	83,	1	},
{	0,	61,	59,	65,	63,	74,	89,	87,	1	},
{	0,	67,	60,	59,	61,	71,	86,	91,	1	},
{	0,	63,	56,	60,	62,	70,	84,	91,	1	},
{	0,	60,	54,	59,	65,	73,	83,	84,	1	},
{	0,	60,	58,	60,	61,	73,	84,	88,	1	},
{	0,	62,	59,	63,	64,	70,	84,	84,	1	},
{	0,	63,	59,	64,	66,	72,	84,	90,	1	},
{	0,	65,	59,	66,	65,	68,	82,	85,	1	},
{	0,	63,	56,	63,	65,	72,	82,	89,	1	},
{	0,	67,	60,	66,	65,	75,	86,	87,	1	},
{	0,	63,	57,	67,	66,	79,	86,	89,	1	},
{	0,	66,	59,	64,	68,	68,	97,	83,	1	},
{	0,	65,	61,	64,	68,	77,	86,	89,	1	},
{	0,	66,	57,	65,	69,	78,	85,	85,	1	},
{	0,	67,	57,	64,	71,	75,	89,	87,	1	},
{	0,	65,	62,	62,	65,	77,	84,	85,	1	},
{	0,	61,	54,	60,	61,	74,	87,	83,	1	},
{	0,	65,	53,	60,	62,	69,	85,	83,	1	},
{	0,	66,	55,	63,	65,	68,	85,	90,	1	},
{	0,	63,	57,	59,	67,	71,	82,	93,	1	},
{	0,	63,	57,	62,	65,	76,	82,	88,	1	},
{	0,	64,	57,	62,	67,	68,	83,	84,	1	},
{	0,	68,	63,	68,	64,	74,	86,	84,	1	},
{	0,	70,	62,	68,	65,	81,	89,	83,	1	},
{	0,	67,	59,	62,	66,	80,	96,	82,	1	},
{	0,	66,	59,	64,	67,	77,	87,	85,	1	},
{	0,	66,	59,	65,	68,	75,	88,	84,	1	},
{	0,	67,	59,	62,	65,	71,	91,	84,	1	},
{	0,	69,	61,	62,	62,	75,	85,	84,	1	},
{	0,	68,	58,	65,	65,	76,	87,	82,	1	},
{	0,	66,	62,	64,	68,	73,	89,	83,	1	},
{	0,	68,	58,	65,	67,	83,	89,	86,	1	},
{	0,	65,	58,	62,	67,	77,	86,	91,	1	},
{	0,	65,	58,	64,	69,	81,	88,	90,	1	},
{	0,	65,	56,	63,	71,	77,	89,	85,	1	},
{	0,	64,	59,	65,	70,	84,	90,	89,	1	},
{	0,	42,	53,	62,	38,	66,	65,	69,	2	},
{	0,	44,	55,	61,	41,	66,	72,	68,	2	},
{	0,	41,	58,	56,	40,	73,	69,	73,	2	},
{	0,	40,	55,	56,	41,	70,	74,	73,	2	},
{	0,	38,	55,	53,	37,	72,	71,	73,	2	},
{	0,	38,	54,	56,	45,	56,	72,	68,	2	},
{	0,	38,	52,	54,	38,	64,	73,	77,	2	},
{	0,	37,	59,	57,	38,	69,	68,	73,	2	},
{	0,	37,	61,	61,	37,	71,	68,	73,	2	},
{	0,	37,	56,	56,	38,	68,	70,	66,	2	},
{	0,	37,	59,	57,	43,	73,	65,	66,	2	},
{	0,	39,	54,	61,	43,	75,	64,	74,	2	},
{	0,	42,	57,	61,	43,	73,	67,	66,	2	},
{	0,	40,	56,	58,	42,	67,	62,	71,	2	},
{	0,	41,	56,	54,	41,	76,	65,	68,	2	},
{	0,	43,	55,	55,	39,	69,	67,	71,	2	},
{	0,	41,	56,	56,	38,	72,	67,	70,	2	},
{	0,	41,	56,	60,	39,	72,	74,	66,	2	},
{	0,	44,	52,	60,	37,	66,	67,	73,	2	},
{	0,	43,	55,	63,	37,	64,	67,	76,	2	},
{	0,	40,	59,	57,	43,	74,	65,	66,	2	},
{	0,	38,	57,	61,	38,	69,	73,	70,	2	},
{	0,	39,	62,	58,	37,	69,	73,	72,	2	},
{	0,	35,	58,	61,	38,	67,	71,	71,	2	},
{	0,	26,	55,	55,	38,	71,	71,	70,	2	},
{	0,	38,	58,	59,	41,	65,	68,	74,	2	},
{	0,	27,	55,	57,	37,	67,	71,	71,	2	},
{	0,	19,	59,	67,	35,	65,	66,	74,	2	},
{	0,	18,	63,	62,	38,	72,	71,	73,	2	},
{	0,	14,	58,	60,	38,	74,	74,	73,	2	},
{	0,	17,	66,	61,	37,	68,	75,	77,	2	},
{	0,	16,	70,	58,	14,	73,	71,	80,	2	},
{	0,	19,	62,	56,	13,	74,	72,	77,	2	},
{	0,	18,	62,	56,	15,	71,	70,	79,	2	},
{	0,	18,	62,	59,	14,	73,	71,	78,	2	},
{	0,	17,	63,	60,	14,	72,	72,	77,	2	},
{	0,	17,	61,	60,	15,	72,	69,	79,	2	},
{	0,	17,	74,	60,	15,	73,	71,	80,	2	},
{	0,	16,	59,	60,	35,	69,	81,	78,	2	},
{	0,	12,	60,	62,	14,	71,	77,	71,	2	},
{	0,	16,	58,	58,	13,	68,	76,	90,	2	},
{	0,	21,	61,	62,	16,	76,	74,	74,	2	},
{	0,	36,	57,	60,	20,	71,	74,	74,	2	},
{	0,	39,	56,	58,	37,	64,	76,	72,	2	},
{	0,	36,	57,	61,	38,	63,	79,	71,	2	},
{	0,	38,	60,	57,	38,	65,	79,	76,	2	},
{	0,	38,	55,	54,	42,	63,	78,	71,	2	},
{	0,	38,	58,	53,	40,	63,	77,	70,	2	},
{	0,	37,	61,	54,	37,	66,	74,	75,	2	},
{	0,	41,	57,	51,	40,	66,	78,	71,	2	},
{	0,	48,	54,	50,	49,	61,	81,	84,	3	},
{	0,	54,	53,	54,	50,	63,	79,	77,	3	},
{	0,	50,	56,	54,	50,	71,	79,	77,	3	},
{	0,	49,	57,	52,	51,	60,	89,	83,	3	},
{	0,	48,	52,	54,	47,	61,	80,	86,	3	},
{	0,	46,	56,	53,	53,	61,	87,	77,	3	},
{	0,	52,	56,	58,	48,	59,	87,	92,	3	},
{	0,	45,	51,	59,	53,	62,	82,	85,	3	},
{	0,	46,	56,	57,	55,	66,	82,	85,	3	},
{	0,	49,	53,	55,	46,	59,	81,	93,	3	},
{	0,	49,	52,	58,	46,	57,	77,	77,	3	},
{	0,	49,	49,	53,	47,	57,	80,	77,	3	},
{	0,	50,	49,	54,	48,	62,	79,	75,	3	},
{	0,	56,	51,	47,	51,	71,	79,	75,	3	},
{	0,	60,	50,	49,	54,	71,	83,	82,	3	},
{	0,	60,	54,	50,	50,	60,	84,	85,	3	},
{	0,	48,	56,	50,	45,	61,	80,	80,	3	},
{	0,	49,	49,	53,	48,	63,	84,	88,	3	},
{	0,	48,	50,	55,	50,	66,	78,	75,	3	},
{	0,	53,	55,	55,	53,	66,	79,	86,	3	},
{	0,	46,	58,	54,	49,	62,	81,	88,	3	},
{	0,	46,	56,	54,	49,	63,	81,	82,	3	},
{	0,	47,	54,	55,	47,	66,	78,	86,	3	},
{	0,	47,	53,	49,	49,	66,	76,	80,	3	},
{	0,	45,	54,	48,	49,	65,	78,	81,	3	},
{	0,	45,	53,	55,	49,	63,	78,	81,	3	},
{	0,	46,	54,	53,	48,	64,	78,	79,	3	},
{	0,	45,	54,	54,	48,	63,	78,	82,	3	},
{	0,	45,	53,	55,	50,	63,	83,	82,	3	},
{	0,	45,	55,	54,	47,	63,	78,	80,	3	},
{	0,	46,	53,	54,	46,	63,	79,	82,	3	},
{	0,	46,	52,	54,	47,	64,	79,	81,	3	},
{	0,	46,	60,	54,	48,	63,	80,	83,	3	},
{	0,	46,	54,	53,	47,	63,	85,	80,	3	},
{	0,	47,	55,	55,	49,	67,	85,	80,	3	},
{	0,	46,	58,	55,	49,	64,	78,	84,	3	},
{	0,	46,	60,	56,	47,	66,	83,	85,	3	},
{	0,	49,	52,	61,	52,	61,	82,	88,	3	},
{	0,	48,	55,	58,	49,	67,	83,	88,	3	},
{	0,	48,	52,	52,	56,	68,	81,	84,	3	},
{	0,	49,	51,	58,	45,	65,	83,	84,	3	},
{	0,	52,	60,	59,	40,	60,	81,	81,	3	},
{	0,	52,	56,	56,	41,	63,	77,	80,	3	},
{	0,	48,	57,	54,	50,	66,	83,	78,	3	},
{	0,	49,	53,	51,	53,	67,	81,	83,	3	},
{	0,	48,	53,	51,	50,	66,	79,	86,	3	},
{	0,	47,	55,	54,	50,	72,	80,	88,	3	},
{	0,	49,	52,	56,	48,	55,	81,	82,	3	},
{	0,	53,	54,	59,	54,	62,	81,	82,	3	},
{	0,	55,	51,	52,	48,	60,	78,	86,	3	},
{	0,	58,	56,	47,	62,	36,	85,	84,	4	},
{	0,	61,	52,	49,	56,	46,	84,	83,	4	},
{	0,	55,	50,	51,	61,	48,	82,	79,	4	},
{	0,	61,	52,	43,	60,	47,	89,	85,	4	},
{	0,	58,	59,	44,	57,	54,	82,	89,	4	},
{	0,	59,	52,	59,	61,	54,	87,	89,	4	},
{	0,	59,	51,	56,	59,	51,	87,	86,	4	},
{	0,	59,	52,	56,	59,	51,	89,	84,	4	},
{	0,	59,	52,	56,	59,	51,	89,	87,	4	},
{	0,	59,	52,	57,	59,	50,	88,	88,	4	},
{	0,	59,	53,	57,	60,	51,	89,	95,	4	},
{	0,	59,	54,	59,	60,	50,	87,	86,	4	},
{	0,	59,	53,	56,	59,	51,	87,	89,	4	},
{	0,	59,	53,	57,	59,	50,	88,	88,	4	},
{	0,	59,	57,	56,	61,	52,	86,	85,	4	},
{	0,	60,	54,	54,	60,	64,	88,	88,	4	},
{	0,	59,	53,	57,	60,	51,	87,	88,	4	},
{	0,	58,	52,	58,	60,	52,	86,	89,	4	},
{	0,	59,	52,	56,	58,	55,	88,	87,	4	},
{	0,	59,	52,	55,	60,	55,	87,	88,	4	},
{	0,	59,	51,	54,	59,	55,	87,	88,	4	},
{	0,	59,	51,	55,	59,	53,	88,	88,	4	},
{	0,	59,	56,	55,	59,	54,	87,	88,	4	},
{	0,	59,	52,	55,	59,	55,	88,	85,	4	},
{	0,	58,	51,	56,	59,	54,	87,	87,	4	},
{	0,	59,	50,	55,	59,	54,	88,	87,	4	},
{	0,	59,	50,	55,	59,	53,	86,	87,	4	},
{	0,	59,	50,	59,	59,	55,	85,	87,	4	},
{	0,	59,	51,	55,	59,	54,	87,	88,	4	},
{	0,	59,	51,	57,	59,	53,	87,	92,	4	},
{	0,	59,	53,	56,	60,	53,	85,	86,	4	},
{	0,	59,	53,	57,	62,	55,	88,	85,	4	},
{	0,	58,	52,	57,	60,	52,	86,	88,	4	},
{	0,	58,	50,	54,	60,	53,	86,	89,	4	},
{	0,	59,	52,	57,	60,	54,	91,	89,	4	},
{	0,	59,	52,	55,	59,	52,	88,	87,	4	},
{	0,	57,	52,	56,	60,	52,	91,	85,	4	},
{	0,	57,	51,	56,	57,	50,	88,	86,	4	},
{	0,	57,	50,	58,	60,	51,	87,	88,	4	},
{	0,	60,	50,	57,	60,	50,	89,	86,	4	},
{	0,	59,	51,	56,	58,	51,	95,	84,	4	},
{	0,	58,	51,	56,	58,	50,	88,	88,	4	},
{	0,	59,	51,	56,	58,	50,	88,	86,	4	},
{	0,	59,	50,	57,	59,	51,	87,	85,	4	},
{	0,	59,	51,	57,	59,	52,	87,	86,	4	},
{	0,	59,	50,	57,	61,	51,	85,	86,	4	},
{	0,	59,	51,	54,	60,	50,	87,	86,	4	},
{	0,	59,	51,	57,	59,	51,	89,	86,	4	},
{	0,	59,	51,	56,	61,	50,	86,	86,	4	},
{	0,	59,	50,	57,	60,	49,	91,	86,	4	},
};


//test = 0x100;

static Point test [20] = {
{	0, 62,	53,	55,	60,	68,	76,	79,	0	},
{	0, 	62,	51,	54,	60,	74,	74,	82,	0	},
{	0, 	61,	57,	58,	62,	67,	78,	76,	0	},
{	0, 	59,	50,	56,	59,	62,	78,	79,	0	},
{	0, 	59,	49,	57,	58,	65,	76,	79,	0	},
{	0, 	47,	60,	56,	48,	85,	85,	81,	0	},
{	0, 	50,	56,	55,	47,	63,	86,	77,	0	},
{	0, 	48,	57,	56,	49,	64,	87,	76,	0	},
{	0, 	46,	57,	55,	44,	65,	86,	77,	0	},
{	0, 	45,	58,	54,	46,	69,	87,	77,	0	},
{	0,  52,	60,	51,	54,	61,	86,	87,	0	},
{	0,  55,	60,	50,	55,	63,	88,	87,	0	},
{	0,  55,	60,	51,	53,	63,	85,	87,	0	},
{	0,  53,	58,	51,	51,	62,	84,	85,	0	},
{	0,  53,	68,	50,	51,	77,	85,	87,	0	},
{	0,  59,	59,	48,	66,	50,	86,	94,	0	},
{	0,  59,	56,	50,	62,	47,	87,	90,	0	},
{	0,  62,	59,	46,	65,	45,	87,	88,	0	},
{	0,  62,	58,	52,	61,	41,	90,	85,	0	},
{	0,  59,	50,	45,	60,	45,	88,	87,	0	}
};

    int n = 200; // Number of data points

    /*Testing Point*/

    // Parameter to decide group of the testing point
    int k = 3;
    int class[20] ;
    //int* class = ;
    for (int z = 0; z < 20; z++){
		    //class[z] = 1 ;
			class[z] = classifyAPoint(arr, n, k, test[z]) ;
			printf("\n Classified as %d\n", class[z]);


	}
	return class;

}

// http://www.bytecraft.com/Fixed_Point_Converter

//int* a; a = 0x100;    256
//int* b; b = 0x200;	512

// Used to sort an array of points by increasing
// order of distance


void selectionsort(Point* arr, int size, int amount)

{

    for (int i = 0; i < amount; i++)

    {

        int min = i;

        for (int j = i; j <= size-1; j++)

        {

            if (arr[j].distance < arr[min].distance)

            {

                min = j;

            }

        }

	Point temp = arr[i] ;
	arr[i] = arr[min] ;
	 arr[min]  = temp;
       // swap(arr[i], );

    }


}

// This function finds classification of point p using
// k nearest neighbour algorithm. It assumes only two
// groups and returns 0 if p belongs to group 0, else
// 1 (belongs to group 1).
int classifyAPoint(Point* arr, int n, int k, Point p)
{
    // Fill distances of all points from p
    for (int i = 0; i < n; i++){
        arr[i].distance =   ((arr[i].a - p.a) * (arr[i].a - p.a) +
                             (arr[i].b - p.b) * (arr[i].b - p.b) +
                             (arr[i].c - p.c) * (arr[i].c - p.c) +
                             (arr[i].d - p.d) * (arr[i].d - p.d) +
                             (arr[i].e - p.e) * (arr[i].e - p.e) +
                             (arr[i].f - p.f) * (arr[i].f - p.f) +
                             (arr[i].g - p.g) * (arr[i].g - p.g));

               // printf(" %d\n ", arr[i].distance);
    }

    // Sort the Points by distance from p
    selectionsort(arr, n,k);
      // printf("\n as \n");
	   
   //  for (int i = 0; i < n; i++){
     //  printf("%d ", arr[i].distance);
     //  printf(": %d / ", arr[i].x);


   // }
           // printf("\n");

    // Now consider the first k elements and only
    // 4 groups
    int freq1 = 0;     // Frequency of group 1
    int freq2 = 0;     // Frequency of group 2
    int freq3 = 0;     // Frequency of group 3
    int freq4 = 0;     // Frequency of group 4
    for (int i = 0; i < k; i++)
    {
        if (arr[i].val == 1)
            freq1++;
        else if (arr[i].val == 2)
            freq2++;
	    else if (arr[i].val == 3)
            freq3++;
        else if (arr[i].val == 4)
            freq4++;
    }
	//	return 1;

	if (freq1 >= freq3 && freq1 >= freq2 && freq1 >= freq4)
		return 1;
	if (freq2 >= freq1 && freq2 >= freq3 && freq2 >= freq4)
		return 2;
	if (freq3 >= freq2 && freq3 >= freq1 && freq3 >= freq4)
		return 3;
    if (freq4 >= freq2 && freq4 >= freq1 && freq4 >= freq3)
		return 4;
}

// Driver code
int main()
{

int* i;
i = knn();

    return 0;
}
